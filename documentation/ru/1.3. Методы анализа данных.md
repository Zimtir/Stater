# Методы анализа данных

_В данном документе представлен пункт 1.3 из раздела **Глава 1**_

## Кластерный анализ

Термин «кластерный анализ» (впервые ввел Tryon в 1939 г.) в действительности включает в себя набор различных алгоритмов классификации. Общий вопрос, задаваемый исследователями во многих областях, состоит в том, как разбить данные на группы с близкими значениями параметров.Например, при сегментации рынка можно кластеризовать потребителей по двум параметрам — цены и качества. Допустим, компания — производитель автомобилей провела опрос потребителей, в котором задавала два вопроса: «За какую цену Вы готовы купить автомобиль?» и «Оцените качество автомобиля X по 50-балльной шкале» (несколько странный вопрос, однако в качестве иллюстрации он вполне подходит). В результате опроса были получены следующие данные (см. схему; данные в табличной форме не носят информативный характер):

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%A0%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D1%8B%20%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D0%B0.png)

Если посмотреть на диаграмму (так называемая диаграмма рассеяния) «цена — качество», представленную на рис. 1, то сразу будут видны группы потребителей:

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%A1%D0%BE%D0%BE%D1%82%D0%BD%D0%BE%D1%88%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%86%D0%B5%D0%BD%D1%8B%20-%20%D0%BA%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B0.png)

Владея этой информацией, каждой группе потребителей можно предложить именно то, что необходимо именно этой группе, и за счет этого увеличить уровень продаж компании.Разумеется, в реальной жизни кластеры, различимые глазом, встречаются нечасто, гораздо чаще бывают ситуации, когда все результирующие параметры смешиваются в одну «кучу» (см. рис. 2)

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%20%D1%80%D0%B0%D1%81%D1%81%D0%B5%D1%8F%D0%BD%D0%B8%D1%8F.png)

Особенно часто это встречается, когда анализируемых параметров не два, а несколько десятков (кластерный анализ не ограничивает число анализируемых параметров, поэтому можно рассматривать всю проблему комплексно).Глазом кластеры выделить не получится, однако с помощью алгоритмов кластерного анализа это сделать можно.Для проведения кластерного анализа, кроме сбора данных, необходимо определить две вещи: на какое количество кластеров необходимо разделить данные и как определить меру сходства в данных. Например, все предприятия России можно кластеризовать по географическому признаку на 10 кластеров. Тогда мера сходства будет определяться коммуникационной близостью предприятий друг к другу. В более сложных случаях можно применять другие меры сходства, которые подробно описаны в литературе по кластерному анализу. Существует много разных мер сходства, наиболее употребительны из них порядка десяти, но подробно останавливаться на мерах сходства не будем.

## Факторный анализ

В случае наличия большого числа параметров (более 100) имеет смысл сгруппировать параметры и анализировать уже не каждый параметр в отдельности, а группы параметров как единый комплексный параметр (фактор).В основе факторного анализа лежит идея о том, что за сложными взаимосвязями явно заданных признаков стоит относительно более простая структура, отражающая наиболее существенные черты изучаемого явления, а «внешние» признаки являются функциями скрытых общих факторов, определяющих эту структуру.Например, для анализа структуры экономического роста России можно проанализировать все макроэкономические параметры, предварительно объединив их в группы. Одним из таких факторов будет являться ВВП.Объединение параметров можно делать вручную, эмпирически, как это сделано с ВВП, а можно с помощью метода факторного анализа. Применение факторного анализа позволяет, во-первых, уменьшать (редуцировать) число рассматриваемых параметров, во-вторых — находить осмысленные группы параметров, каждая из которых будет являться одним самостоятельным параметром.Спецификой этого метода является то, что при объединении параметров в факторы каждый фактор аккумулирует в себе общие закономерности во всех параметрах, отбрасывая особенности каждого параметра в отдельности.

## Нейронные сети

Начало нейронным сетям как инструменту анализа данных было положено в начале 40-х годов в работе МакКаллока и Питтса. В этой работе предлагалась модель искусственного нейрона.Предполагалось, что, моделируя нейронную структуру мозга, возможно приблизиться к искусственному интеллекту. К тому времени уже было известно, что мозг человека состоит из особых биологических кле-ток – нейронов, и казалось, что построение сетей из нейронов позволит решать сложные задачи, которые ежедневно решает мозг человека. С тех пор интерес к нейронным сетям периодически то возрастал, то спадал, что обуславливалось новыми разработками в этой области, и сейчас нейронные сети являются одним из достаточно популярных инструментов анализа данных.Нейронные сети могут быть применены практически к любой области деятельности, что сильно привлекает многих исследователей.

### Задачи, которые ставятся перед нейронными сетями

По мнению Anil K. Jain из Мичиганского государственного университета и специалистов Исследовательского центра IBM Jianchang Mao и K. M. Mohiuddin, список задач для нейронных сетей можно классифицировать следующим образом.Классификация образов. К известным приложениям относятся распознавание букв, распознавание речи, классификация сигнала электрокардиограммы, классификация клеток крови, обеспечение деятельности биометрических сканеров и т. п.Кластеризация / категоризация. Кластеризация применяется для извлечения знаний, сжатия данных и исследования свойств данных.Аппроксимация функций. Типичным примером является шумоподавление при приеме сигнала различной природы, вне зависимости от передаваемой информации.Предсказание / прогноз. В качестве примера можно привести предсказание цен на фондовой бирже и прогноз погоды.Оптимизация. Назначение штата работников по ряду умений и факторов являются классическими примерами задач оптимизации.Память, адресуемая по содержанию (ассоциативная память). Ассоциативная память доступна по указанию заданного содержания. Содержимое памяти может быть вызвано даже по частичному входу или искаженному содержанию. Ассоциативная память может найти применение при создании мультимедийных информационных баз данных.Управление. Примером является оптимальное управление двигателем, рулевое управление на кораблях, самолетах.

### Как работает нейронная сеть

Предположим, что нам даются наборы чисел (входные векторы), и для каждого из них нам сообщают значение функции, которое она имеет на данном наборе. Пример: значением является обменный курс некоторой валюты на следующий день, вход – уровень этого курса и некоторых других финансовых показателей за, скажем, последний месяц. Другой пример: входной вектор – характеристики заемщика банка (возраст фирмы, капитал, количество занятых, подвергался ли судимости директор и т. п.), результат – выполнил ли клиент условия возврата кредита. В обоих случаях речь идет пока об исторических данных. Затем нам предъявляют уже новые данные: значения финансовых показателей по сегодняшний день включительно или данные о новом клиенте, обратившемся с просьбой о предоставлении кредита. Результат теперь неизвестен, и мы должны его (хотя бы приближенно) найти: каким будет обменный курс завтра, перспективен ли для банка данный клиент. Как действует в этой ситуации нейронная сеть? Элементарная операция, которую она производит с данными, состоит в следующем: берется «взвешенная» сумма входных величин (т. е. сумма, взятая с некоторыми коэффициентами, которые называются весами). Затем полученная величина преобразуется с помощью нелинейной монотонной функции (функции активации) так, чтобы получившееся в результате значение лежало в интервале от 0 до 1. Описанная конструкция называется искусственным нейроном. Сеть состоит из многих таких нейронов, причем часть из них обрабатывает непосредственно входные данные (первый слой нейронов), другие – сигналы, полученные на выходе с нейронов первого слоя и т. д. (скрытые слои нейронов), и, наконец, есть единственный выходной нейрон, который и выдает нам результат. При этом веса, соответствующие различным нейронам (а иногда и параметры функций активации), могут меняться независимо друг от друга. Обрабатывая исторические (обучающие) данные и меняя при этом веса, сеть стремится наилучшим образом приспособить свой выходной сигнал к известному результату. Этот процесс называется обучением сети. После того как оно закончено, на вход сети можно подать новые данные, и она выдает свой прогноз.

### Общая схема анализа данных с помощью нейронных сетей

Общая схема анализа данных с помощью нейронных сетей состоит из 5 этапов.Выбор типологии сети.Существует 9 типов сетей, на этом этапе подбирается наиболее подходящий под задачу тип сети.Экспериментальный подбор характеристик сети. После выбора типа необходимо подобрать структуру сети (количество нейронов, их веса, взаимосвязи и т. д.).Экспериментальный подбор параметров обучения. Далее необходимо экспериментально определить параметры обучения: максимальное время обучения, количество данных, максимально допустимую ошибку и т. д.Обучение сети. По обучающей выборке проводится обучение сети. Предполагается, что обучающая выборка содержит в себе информацию, которая характеризует данные в целом.Проверка адекватности обучения. Проводится анализ полученных результатов на данных, которые не входили в обучающую выборку. Осуществляется ручной контроль результатов работы нейронной сети.

### Минусы подхода

Основным минусом нейронных сетей является то, что процесс обучения нейронной сети и процесс принятия решений абсолютно неконтролируемы. Другими словами, нейронная сеть представляет из себя «черный ящик», на входе которого подаются данные, а на выходе получается результат. Что делает внутри себя нейронная сеть, понять невозможно, поскольку анализируются тестовые данные (происходит обучение нейронной сети), при этом система старается минимизировать ошибку, автоматически изменяя внутренние параметры (веса). Несомненно, получить значения весов в обученной сети возможно, но единственный ответ, который могут дать эти веса, такой: какой параметр в тестовых данных играет какую роль, какую степень важности он имеет. Никаких объяснений относительно смысла этих ролей с помощью этого метода получить невозможно.

## Деревья решений

Первые идеи создания деревьев решений восходят к работам Ховленда (Hoveland) и Ханта (Hunt) конца 50-х годов XX века. Однако основополагающей работой, давшей импульс для развития этого направления, явилась книга Ханта (Hunt E.B.), Мэрина (Marin J.) и Стоуна (Stone P.J.) «Experimentsin Induction», увидевшая свет в 1966 г. Деревья решений — это способ представления правил в иерархической последовательной логической структуре, который позволяет соотнести объект или ситуацию на входе с одним или несколькими выходными (терминальными) узлами. Под правилом понимается логическая конструкция, представленная в виде «если... то».Рассмотрим следующую задачу: необходимо построить решающее правило по выдаче кредита физическим лицам. В этом случае дереворешений может выглядеть следующим образом (рис. 3):

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%A7%D0%B5%D1%82%D0%BA%D0%BE%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9.png)

В предыдущем примере приведено так называемое четкое дерево решений. Неменьший интерес представляют вероятностные деревья решений
(рис. 4), в которых каждый параметр принятия решения может входить в результирующее решение с некоторой вероятностью:

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%92%D0%B5%D1%80%D0%BE%D1%8F%D1%82%D0%BD%D0%BE%D1%81%D1%82%D0%BD%D0%BE%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9.png)

Метод деревьев решений может помочь при принятии сложного решения, на которое влияют десятки параметров.
Деревья решений широко применяются во многих областях деятельности:
1. Банковское дело. Оценка кредитоспособности клиентов банка при выдаче кредитов.
2. Промышленность. Контроль за качеством продукции (выявление дефектов), испытания без разрушений (например, проверка качества сварки)
и т. д.
3. Медицина. Диагностика различных заболеваний.
4. Молекулярная биология. Анализ строения аминокислот.
5. Консалтинг. Компания McKinsey использует деревья решений (issue tree, термин McKinsey) для консультаций своих клиентов.
Это далеко не полный список областей, где можно использовать деревья решений. Не исследованы еще многие потенциальные области применения этого инструмента.

## Регрессионный анализ

Основной целью регрессионного анализа является определение наличия и характера связи между переменными (в простейшем случае строится зависимость y(x) исходя из примерной формы кривой).Несколько лет назад американский Институт стратегического планирования провел исследование «Маркетинговая стратегия и уровень прибыли», в котором рассматривалось влияние наиболее значимых переменных на уровень прибыли компании. Выяснилось, что график зависимости рентабельности от доли рынка выглядит следующим образом (рис. 5):

![Image alt](https://github.com/Zimtir/Stater/blob/master/documentation/ru/images/%D0%93%D1%80%D0%B0%D1%84%D0%B8%D0%BA%20%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8%20%D1%80%D0%B5%D0%BD%D1%82%D0%B0%D0%B1%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8%20%D0%BE%D1%82%20%D0%B4%D0%BE%D0%BB%D0%B8%20%D1%80%D1%8B%D0%BD%D0%BA%D0%B0.png)

Невооруженным взглядом видно, что это прямая, однако точные ее параметры помогает установить регрессионный анализ. Регрессионный анализ широко используется в офисном пакете Excel, который предоставляет возможность исследовать не только линейные, но и другие, более сложные зависимости (в Excel это называется построением линий трендов).

## Дискриминантный анализ

Дискриминантный анализ – это инструмент статистики, который используется для принятия решения о том, какие переменные разделяют возникающие наборы данных. Например, некий исследователь в области образования решает исследовать, какие переменные относят выпускника средней школы к одной из трех категорий: (1) поступающий в колледж, (2) поступающий в профессиональную школу или (3) отказывающийся от дальнейшего образования или профессиональной подготовки. Для этой цели исследователь может собрать данные о различных переменных, связанных с учащимися школы: пол, возраст, успеваемость, материальное положение семьи и т. д. После выпуска большинство учащихся должно попасть в одну из названных категорий. Затем можно использовать дискриминантный анализ для определения того, какие переменные дают наилучшее предсказание выбора учащимися дальнейшего пути. Например, можно математически определить, что учащиеся с низкой успеваемостью и низким достатком в семье скорее всех попадают в 3-ю категорию.Еще пример: есть данные о клиентах / потребителях, которых можно разделить по группам (совершившие повторную покупку – не совершившие повторную покупку; покупатели марки А – покупатели марки В – покупатели марки С; высокие риски невозврата кредита – низкие риски невозврата кредита), также имеется дополнительная информация о клиентах / потребителях. Дискриминантный анализ позволяет выяснить, действительно ли группы различаются между собой, и если да, то каким образом (какие переменные вносят наибольший вклад в имеющиеся различия).

## Корреляционный анализ

Корреляционный анализ позволяет судить о том, насколько похоже ведут себя разные переменные [14]. В самом общем виде принятие гипотезы о наличии корреляции означает, что изменение значения переменной А произойдет одновременно с пропорциональным изменением значения Б: если обе переменные растут, то корреляция положительная; если одна переменная растет, а вторая уменьшается – корреляция отрицательная.При изучении корреляций стараются установить, существует ли какая-то связь между двумя показателями в одной выборке (например, между ростом и весом детей или между уровнем IQ и школьной успеваемостью) либо между двумя различными выборками (например, при сравнении пар близнецов), и если эта связь существует, то сопровождается ли увеличение одного показателя возрастанием (положительная корреляция) или уменьшением (отрицательная корреляция) другого.

